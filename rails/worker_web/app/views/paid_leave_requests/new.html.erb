<div class="space-y-4">
  <div class="bg-white rounded-lg shadow p-4">
    <h2 class="text-lg font-semibold text-gray-900 mb-4">有給申請</h2>

    <%# 残日数表示 %>
    <div class="text-center p-3 bg-blue-50 rounded-lg mb-4">
      <div class="text-2xl font-bold text-blue-600" data-paid-leave-form-target="remainingDisplay"><%= @remaining_days.to_f %></div>
      <div class="text-sm text-gray-600">残り日数</div>
    </div>

    <%# エラー表示 %>
    <% if @request.errors.any? %>
      <div class="bg-red-50 border border-red-200 rounded-lg p-3 mb-4">
        <ul class="list-disc list-inside text-sm text-red-700">
          <% @request.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <%= form_with model: @request, url: paid_leave_requests_path, data: { controller: "paid-leave-form", paid_leave_form_remaining_value: @remaining_days.to_f } do |f| %>
      <div class="space-y-4">
        <%# 日付 %>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">取得日</label>
          <%= f.date_field :leave_date, min: Date.current,
              class: "w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg",
              required: true %>
        </div>

        <%# 休暇タイプ %>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">休暇タイプ</label>
          <div class="space-y-2">
            <label class="flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
              <%= f.radio_button :leave_type, "full",
                  class: "mr-3 text-blue-600",
                  data: { action: "change->paid-leave-form#updateConsumed" } %>
              <div>
                <span class="text-sm font-medium text-gray-900">全休</span>
                <span class="text-xs text-gray-500 ml-2">(1.0日)</span>
              </div>
            </label>
            <label class="flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
              <%= f.radio_button :leave_type, "half_am",
                  class: "mr-3 text-blue-600",
                  data: { action: "change->paid-leave-form#updateConsumed" } %>
              <div>
                <span class="text-sm font-medium text-gray-900">午前半休</span>
                <span class="text-xs text-gray-500 ml-2">(0.5日)</span>
              </div>
            </label>
            <label class="flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
              <%= f.radio_button :leave_type, "half_pm",
                  class: "mr-3 text-blue-600",
                  data: { action: "change->paid-leave-form#updateConsumed" } %>
              <div>
                <span class="text-sm font-medium text-gray-900">午後半休</span>
                <span class="text-xs text-gray-500 ml-2">(0.5日)</span>
              </div>
            </label>
          </div>
        </div>

        <%# 消費日数 %>
        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
          <span class="text-sm text-gray-700">消費日数</span>
          <span class="text-lg font-bold text-gray-900" data-paid-leave-form-target="consumedDisplay">1.0</span>
        </div>

        <%# 理由 %>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">理由（任意）</label>
          <%= f.text_area :reason, rows: 3,
              class: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
              placeholder: "例: 通院のため" %>
        </div>

        <%# 送信ボタン %>
        <div class="pt-2">
          <%= f.submit "申請する",
              class: "w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-200 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",
              disabled: @remaining_days.to_f <= 0 %>
        </div>

        <div class="text-center">
          <%= link_to "戻る", paid_leave_requests_path, class: "text-sm text-gray-500 hover:text-gray-700" %>
        </div>
      </div>
    <% end %>
  </div>
</div>
