<%# Usage: render "shared/photos_field", f: form_builder, resource: model_instance %>
<div class="mt-6">
  <%= f.label :photos, "写真添付", class: "block text-sm font-medium text-gray-700" %>
  <div class="mt-1">
    <%= f.file_field :photos, multiple: true, accept: "image/*",
        class: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" %>
  </div>
  <p class="mt-1 text-xs text-gray-500">複数の写真を選択できます（JPEG, PNG対応）</p>

  <% if resource.photos.attached? && resource.persisted? %>
    <div class="mt-3 grid grid-cols-2 sm:grid-cols-4 gap-4">
      <% resource.photos.each do |photo| %>
        <% next unless photo.blob&.persisted? %>
        <div class="relative group">
          <%= image_tag photo, class: "w-full h-24 object-cover rounded-lg" %>
          <div class="absolute inset-0 bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center">
            <%= link_to url_for(photo), target: "_blank", class: "text-white text-sm" do %>
              拡大
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
