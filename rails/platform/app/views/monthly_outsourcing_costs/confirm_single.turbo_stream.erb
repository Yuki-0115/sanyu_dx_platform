<%= turbo_stream.replace "outsourcing_cost_#{@partner.id}_#{@project.id}" do %>
  <%= render partial: "outsourcing_cost_row", locals: {
    partner: @partner,
    project: @project,
    cost: @cost,
    estimated: @estimated,
    year: @year,
    month: @month
  } %>
<% end %>

<%= turbo_stream.replace "partner_#{@partner.id}_totals" do %>
  <%= render partial: "partner_totals", locals: {
    partner: @partner,
    outsourcing_costs: MonthlyOutsourcingCost.for_month(@year, @month).where(partner_id: @partner.id),
    estimated_costs: build_partner_estimated_total(@partner.id),
    year: @year,
    month: @month
  } %>
<% end %>

<%= turbo_stream.replace "total_summary" do %>
  <%= render partial: "total_summary", locals: {
    total: MonthlyOutsourcingCost.total_for_month(@year, @month),
    year: @year,
    month: @month
  } %>
<% end %>

<% if @message %>
  <%= turbo_stream.update "flash_message" do %>
    <div class="mb-4 bg-green-50 border border-green-200 rounded-lg p-3">
      <div class="flex items-center">
        <svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <span class="text-sm text-green-800"><%= @message %></span>
      </div>
    </div>
  <% end %>
<% elsif @error %>
  <%= turbo_stream.update "flash_message" do %>
    <div class="mb-4 bg-red-50 border border-red-200 rounded-lg p-3">
      <div class="flex items-center">
        <svg class="w-5 h-5 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <span class="text-sm text-red-800"><%= @error %></span>
      </div>
    </div>
  <% end %>
<% end %>
