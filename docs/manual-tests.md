# 手動テスト手順書

各機能のDone確認時に使用する手動テスト手順

---

## テンプレート

```
### 機能名

**テスト日**: YYYY-MM-DD
**テスター**: 

#### 前提条件
- 

#### 手順
1. 
2. 
3. 

#### 期待結果
- 

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）
```

---

## 認証機能

**テスト日**: 
**テスター**: 

### ログイン

#### 前提条件
- テストユーザーが作成済み

#### 手順
1. http://localhost:3001/auth/login にアクセス
2. メールアドレス・パスワードを入力
3. ログインボタンをクリック

#### 期待結果
- ダッシュボードにリダイレクトされる
- ヘッダーにユーザー名が表示される

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

### ログアウト

#### 手順
1. ログイン状態でヘッダーのログアウトをクリック

#### 期待結果
- ログイン画面にリダイレクトされる

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

---

## 案件管理

**テスト日**: 
**テスター**: 

### 案件登録

#### 前提条件
- 営業権限でログイン済み
- 顧客マスタに1件以上登録済み

#### 手順
1. 案件一覧画面で「新規登録」をクリック
2. 案件名・顧客・現場住所を入力
3. 保存をクリック

#### 期待結果
- 案件が登録される
- 案件詳細画面に遷移する

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

### 4点チェック

#### 手順
1. 案件詳細画面で「4点チェック」タブを開く
2. 契約書あり/発注書あり/入金条件明記/顧客承認をチェック
3. 保存をクリック

#### 期待結果
- 4点すべてチェックで「4点完了」ステータスになる
- 工務への引継ぎボタンが表示される

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

---

## 日報入力

**テスト日**: 
**テスター**: 

### 日報作成（職長一括入力）

#### 前提条件
- 工事権限（職長）でログイン済み
- 配置表で当日の配置が設定済み

#### 手順
1. 日報入力画面を開く
2. 出面（作業員ごとの出勤状況）を入力
3. 経費があれば入力
4. 下書き保存をクリック
5. 確定をクリック

#### 期待結果
- 下書き保存で「draft」ステータス
- 確定で「confirmed」ステータス
- 確定後は編集不可（訂正申請のみ）

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

---

## 権限テスト（テナント分離）

**テスト日**: 
**テスター**: 

### 他テナントのデータが見えないこと

#### 前提条件
- 2つのテナント（会社A、会社B）が存在
- 各テナントに案件が1件以上存在

#### 手順
1. 会社Aのユーザーでログイン
2. 案件一覧を表示

#### 期待結果
- 会社Aの案件のみ表示される
- 会社Bの案件は表示されない

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

### URLで他テナントのデータにアクセスできないこと

#### 手順
1. 会社Aのユーザーでログイン
2. 会社Bの案件IDを直接URLに入力してアクセス

#### 期待結果
- 403 Forbidden または 404 Not Found が返る
- 会社Bのデータは表示されない

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

---

## n8n API連携

**テスト日**:
**テスター**:

### APIエンドポイント疎通確認

#### 前提条件
- Dockerコンテナが起動済み
- N8N_API_KEY が .env.local に設定済み

#### 手順（curl使用）

```bash
# 案件一覧取得
curl -X GET "http://localhost:3001/api/v1/projects" \
  -H "X-API-Key: development_api_key_change_in_production" \
  -H "X-Tenant-Code: sunyutech"

# 案件サマリー取得
curl -X GET "http://localhost:3001/api/v1/projects/summary" \
  -H "X-API-Key: development_api_key_change_in_production" \
  -H "X-Tenant-Code: sunyutech"

# 日報一覧取得
curl -X GET "http://localhost:3001/api/v1/daily_reports" \
  -H "X-API-Key: development_api_key_change_in_production" \
  -H "X-Tenant-Code: sunyutech"

# 未確認日報取得
curl -X GET "http://localhost:3001/api/v1/daily_reports/unconfirmed" \
  -H "X-API-Key: development_api_key_change_in_production" \
  -H "X-Tenant-Code: sunyutech"
```

#### 期待結果
- 各エンドポイントがJSONレスポンスを返す
- X-API-Keyが不正な場合は401エラー
- X-Tenant-Codeが不正な場合は404エラー

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

### Webhookテスト

#### 手順

```bash
# 案件作成通知
curl -X POST "http://localhost:3001/api/v1/webhooks/project_created" \
  -H "X-API-Key: development_api_key_change_in_production" \
  -H "X-Tenant-Code: sunyutech" \
  -H "Content-Type: application/json" \
  -d '{"project_id": 1}'
```

#### 期待結果
- notification オブジェクトを含むJSONレスポンスが返る

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

---

## 経営ダッシュボード

**テスト日**:
**テスター**:

### ダッシュボード表示

#### 前提条件
- 経営権限（management）でログイン済み
- 案件データが1件以上登録済み

#### 手順
1. http://localhost:3001/ にアクセス

#### 期待結果
- 案件数サマリーカードが表示される
- ステータス別内訳が表示される
- 最近の案件リストが表示される

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

---

## 仮社員相殺

**テスト日**:
**テスター**:

### 相殺データ登録

#### 前提条件
- 経営・経理権限でログイン済み
- 協力会社（仮社員あり）が登録済み

#### 手順
1. 相殺メニューをクリック
2. 新規登録をクリック
3. 協力会社・対象月・給与総額・社会保険・売上を入力
4. 保存をクリック

#### 期待結果
- 相殺データが登録される
- 相殺額・残高が自動計算される

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

### 相殺確定

#### 手順
1. 相殺詳細画面で「確定」をクリック

#### 期待結果
- ステータスが「confirmed」になる
- 確定後は編集不可

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

---

## 作業員Web（Worker Web）

**テスト日**:
**テスター**:

### 作業員ログイン

#### 前提条件
- 作業員（Worker）が登録済み
- 作業員の社員コードと生年月日がわかっている

#### 手順
1. http://localhost:3002/login にアクセス
2. 社員番号を入力（例: WRK001）
3. パスワード（生年月日4桁、例: 0415）を入力
4. ログインをクリック

#### 期待結果
- ダッシュボードにリダイレクトされる
- 作業員名が表示される

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

### ダッシュボード表示

#### 手順
1. ログイン後、ダッシュボードを表示

#### 期待結果
- 今月の出勤日数が表示される
- 今月の労働時間が表示される
- 最近の出勤記録が表示される

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

### 出勤履歴確認

#### 手順
1. 「出勤履歴」タブをタップ
2. 月を変更して表示

#### 期待結果
- 指定月の出勤記録が表示される
- 合計日数・合計時間が表示される

#### 実際の結果
- [ ] OK
- [ ] NG（詳細: ）

---

**Last Updated**: 2026-01-15
